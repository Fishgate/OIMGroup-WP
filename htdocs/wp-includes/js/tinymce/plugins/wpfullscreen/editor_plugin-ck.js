!function(){tinymce.create("tinymce.plugins.wpFullscreenPlugin",{resize_timeout:!1,init:function(e){function t(t,r){var i,s=tinymce.DOM,o=e.getBody(),u=s.get(e.id+"_ifr"),f=e.dom.win.scrollY;n.resize_timeout||(n.resize_timeout=!0,setTimeout(function(){n.resize_timeout=!1},500),i=o.scrollHeight>300?o.scrollHeight:300,i!=u.scrollHeight&&(s.setStyle(u,"height",i+"px"),e.getWin().scrollTo(0,0)),r&&"paste"==r.type&&tinymce.isWebKit&&setTimeout(function(){e.dom.win.scrollTo(0,f)},40))}var n=this,r={},i=tinymce.DOM;e.addCommand("wpFullScreenClose",function(){e.getParam("wp_fullscreen_is_enabled")&&i.win.setTimeout(function(){tinyMCE.remove(e),i.remove("wp_mce_fullscreen_parent"),tinyMCE.settings=tinyMCE.oldSettings},10)}),e.addCommand("wpFullScreenSave",function(){var e,t=tinyMCE.get("wp_mce_fullscreen");t.focus(),e=tinyMCE.get(t.getParam("wp_fullscreen_editor_id")),e.setContent(t.getContent({format:"raw"}),{format:"raw"})}),e.addCommand("wpFullScreenInit",function(){var t,n,i;e=tinyMCE.activeEditor,t=e.getDoc(),n=t.body,tinyMCE.oldSettings=tinyMCE.settings,tinymce.each(e.settings,function(e,t){r[t]=e}),r.id="wp_mce_fullscreen",r.wp_fullscreen_is_enabled=!0,r.wp_fullscreen_editor_id=e.id,r.theme_advanced_resizing=!1,r.theme_advanced_statusbar_location="none",r.content_css=r.content_css?r.content_css+","+r.wp_fullscreen_content_css:r.wp_fullscreen_content_css,r.height=tinymce.isIE?n.scrollHeight:n.offsetHeight,tinymce.each(e.getParam("wp_fullscreen_settings"),function(e,t){r[t]=e}),i=new tinymce.Editor("wp_mce_fullscreen",r),i.onInit.add(function(t){var n=tinymce.DOM,r=n.select("a.mceButton",n.get("wp-fullscreen-buttons"));e.isHidden()?t.setContent(switchEditors.wpautop(t.getElement().value)):t.setContent(e.getContent()),setTimeout(function(){t.onNodeChange.add(function(){tinymce.each(r,function(e){var t,r;(t=n.get("wp_mce_fullscreen_"+e.id.substr(6)))&&(r=t.className,r&&(e.className=r))})})},1e3),t.dom.addClass(t.getBody(),"wp-fullscreen-editor"),t.focus()}),i.render(),"undefined"!=fullscreen&&i.dom.bind(i.dom.doc,"mousemove",function(e){fullscreen.bounder("showToolbar","hideToolbar",2e3,e)})}),e.addCommand("wpFullScreen",function(){"undefined"!=typeof fullscreen&&("wp_mce_fullscreen"==e.id?fullscreen.off():fullscreen.on())}),e.addButton("wp_fullscreen",{title:"wordpress.wp_fullscreen_desc",cmd:"wpFullScreen"}),!e.getParam("fullscreen_is_enabled")&&e.getParam("wp_fullscreen_is_enabled")&&(e.onInit.add(function(e){e.onChange.add(t),e.onSetContent.add(t),e.onPaste.add(t),e.onKeyUp.add(t),e.onPostRender.add(t),e.getBody().style.overflowY="hidden"}),e.getParam("autoresize_on_init",!0)&&e.onLoadContent.add(function(){setTimeout(function(){t()},1200)}),e.addCommand("wpAutoResize",t))},getInfo:function(){return{longname:"WP Fullscreen",author:"WordPress",authorurl:"http://wordpress.org",infourl:"",version:"1.0"}}}),tinymce.PluginManager.add("wpfullscreen",tinymce.plugins.wpFullscreenPlugin)}();