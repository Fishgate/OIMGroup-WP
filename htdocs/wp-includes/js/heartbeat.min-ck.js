window.wp=window.wp||{},function(e){var t=function(){function t(e){return e?parseInt((new Date).getTime()/1e3):(new Date).getTime()}function n(e){var t,n=e.src;if(n&&/^https?:\/\//.test(n)&&(t=window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.host,0!==n.indexOf(t)))return!1;try{if(e.contentWindow.document)return!0}catch(r){}return!1}function r(t,n){var r;if(t){switch(t){case"abort":break;case"timeout":r=!0;break;case"parsererror":case"error":case"empty":case"unknown":k++,k>2&&(r=!0)}503==n&&!1===O&&(r=!0),r&&!E.hasConnectionError()&&(O=!0,e(document).trigger("heartbeat-connection-lost",[t,n]))}else E.hasConnectionError()?(k=0,O=!1,e(document).trigger("heartbeat-connection-restored")):null===O&&(O=!1)}function i(){var n,i,o={},u=!0,f="object"==typeof window.heartbeatSettings?window.heartbeatSettings.nonce:"";T=t(),n=e.extend({},N),N={},e(document).trigger("heartbeat-send",[n]);for(i in n)if(n.hasOwnProperty(i)){u=!1;break}return u&&!E.hasConnectionError()?(m=!1,s(),void 0):(o.data=n,o.interval=v/1e3,o._nonce=f,o.action="heartbeat",o.screen_id=S,o.has_focus=L,m=!0,E.xhr=e.ajax({url:x,type:"post",timeout:3e4,data:o,dataType:"json"}).done(function(t,n,i){var s;return t?(E.hasConnectionError()&&r(),t.nonces_expired?(e(document).trigger("heartbeat-nonces-expired"),void 0):(t.heartbeat_interval&&(s=t.heartbeat_interval,delete t.heartbeat_interval),E.tick(t,n,i),s&&E.interval.call(E,s),void 0)):r("empty")}).always(function(){m=!1,s()}).fail(function(e,t,n){r(t||"unknown",e.status),E.error(e,t,n)}),void 0)}function s(){var e=t()-T,n=v;h&&(L?C>0&&g&&(n=g,C--):n=1e5,window.clearTimeout(p),n>e?p=window.setTimeout(function(){h&&i()},n-e):i())}function o(){window.clearTimeout(w),window.clearTimeout(A),w=A=0,L=!1}function u(){window.clearTimeout(w),window.clearTimeout(A),w=A=0,y=t(),L||(L=!0,window.clearTimeout(p),m||s())}function f(){e("iframe").each(function(t,r){n(r)&&(e.data(r,"wp-heartbeat-focus")||(e.data(r,"wp-heartbeat-focus",1),e(r.contentWindow).on("focus.wp-heartbeat-focus",function(){u()}).on("blur.wp-heartbeat-focus",function(){f(),A=window.setTimeout(function(){o()},500)})))})}function l(){b=!1,e(document).off(".wp-heartbeat-active"),e("iframe").each(function(t,r){n(r)&&e(r.contentWindow).off(".wp-heartbeat-active")}),u()}function c(){var r=y?t()-y:0;r>3e5&&L&&o(),b||(e(document).on("mouseover.wp-heartbeat-active keyup.wp-heartbeat-active",function(){l()}),e("iframe").each(function(t,r){n(r)&&e(r.contentWindow).on("mouseover.wp-heartbeat-active keyup.wp-heartbeat-active",function(){l()})}),b=!0)}var h,p,d,v,m,g,y,b,w,E=this,S="undefined"!=typeof pagenow?pagenow:"",x="undefined"!=typeof ajaxurl?ajaxurl:"",T=0,N={},C=0,k=0,L=!0,A=-1,O=null;this.hasConnectionError=function(){return!!O},"object"==typeof window.heartbeatSettings&&(d=e.extend({},window.heartbeatSettings),x=d.ajaxurl||x,delete d.ajaxurl,delete d.nonce,v=d.interval||15,delete d.interval,15>v?v=15:v>60&&(v=60),v=1e3*v,S=S||d.screenId||"front",delete d.screenId,e.extend(this,d)),e(window).on("blur.wp-heartbeat-focus",function(){f(),w=window.setTimeout(function(){o()},500)}).on("focus.wp-heartbeat-focus",function(){e("iframe").each(function(t,r){n(r)&&(e.removeData(r,"wp-heartbeat-focus"),e(r.contentWindow).off(".wp-heartbeat-focus"))}),u()}),window.setInterval(function(){c()},3e4),e(document).ready(function(){h=!0,T=t(),s()}),this.hasFocus=function(){return L},this.interval=function(e,t){var n,r;if(t=parseInt(t,10)||30,t=1>t||t>30?30:t,e){switch(e){case"fast":r=5,C=t;break;case"slow":r=60,C=0;break;case"long-polling":return v=0,0;default:r=15,C=0}n=v>1e3*r,C>0?g=1e3*r:(v=1e3*r,g=0),n&&s()}return L?g?g/1e3:v/1e3:120},this.enqueue=function(e,t,n){return e?n&&this.isQueued(e)?!1:(N[e]=t,!0):!1},this.isQueued=function(e){return e?N.hasOwnProperty(e):void 0},this.dequeue=function(e){e&&delete N[e]},this.getQueuedItem=function(e){return e?this.isQueued(e)?N[e]:void 0:void 0}};e.extend(t.prototype,{tick:function(t,n,r){e(document).trigger("heartbeat-tick",[t,n,r])},error:function(t,n,r){e(document).trigger("heartbeat-error",[t,n,r])}}),wp.heartbeat=new t}(jQuery);